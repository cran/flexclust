
R : Copyright 2005, The R Foundation for Statistical Computing
Version 2.1.1 Patched (2005-08-17), ISBN 3-900051-07-0

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for a HTML browser interface to help.
Type 'q()' to quit R.

> library(flexclust)
> 
> set.seed(1207)
> 
> x <- cbind(sort(runif(1000)), runif(1000))
> 
> fam1 <- kccaFamily("kmeans")
> fam2 <- kccaFamily("kmedians")
> fam3 <- kccaFamily("kmedians", groupFun="differentClusters")
> 
> k1 <- 30
> k2 <- 5
> 
> cl1 <- kcca(x, k=k1, family=fam1)
> cl1
kcca object of family ‘kmeans’ 

call:
kcca(x = x, k = k1, family = fam1)

cluster sizes:
 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 
35 22 31 24 40 50 29 38 45 35 26 43 41 31 29 34 31 29 21 27 48 40 46 32 32 14 
27 28 29 30 
21 42 31 33 

> cl2 <- kcca(x, k=k2, group=predict(cl1), family=fam2)
> cl2
kcca object of family ‘kmedians’ 

call:
kcca(x = x, k = k2, family = fam2, group = predict(cl1))

cluster sizes:
  1   2   3   4   5 
280 171 203 211 135 

> 
> tab12 <- table(predict(cl1),predict(cl2))
> tab12
    
      1  2  3  4  5
  1   0  0  0 35  0
  2   0  0  0 22  0
  3   0 31  0  0  0
  4   0  0  0 24  0
  5   0  0 40  0  0
  6   0 50  0  0  0
  7   0  0  0  0 29
  8   0  0 38  0  0
  9  45  0  0  0  0
  10 35  0  0  0  0
  11  0 26  0  0  0
  12  0  0  0  0 43
  13 41  0  0  0  0
  14  0  0 31  0  0
  15  0  0  0  0 29
  16  0  0  0  0 34
  17 31  0  0  0  0
  18  0  0  0 29  0
  19  0  0  0 21  0
  20  0  0  0 27  0
  21  0  0 48  0  0
  22 40  0  0  0  0
  23  0  0 46  0  0
  24 32  0  0  0  0
  25  0  0  0 32  0
  26 14  0  0  0  0
  27  0  0  0 21  0
  28 42  0  0  0  0
  29  0 31  0  0  0
  30  0 33  0  0  0
> stopifnot(sum(tab12>0)==k1)
> 
> ###**********************************************************
> 
> ## the first column of x is sorted, hence recycling group membership
> ## gives observations in each group that are easy to seperate
> 
> g <- 1:(nrow(x)/10)
> g <- rep(g, 10)
> cl3 <- kcca(x, k=k1, group=g, family=fam3)
Loading required package: clue
> tab3 <- table(predict(cl3),g)
> tab3
    g
     1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28
  1  1 1 1 0 0 0 0 0 0  0  0  1  0  1  1  0  0  0  1  0  0  1  0  1  0  0  0  0
  2  0 0 0 0 0 1 0 0 0  1  0  0  0  0  0  0  1  0  0  0  0  1  0  1  0  0  0  0
  3  0 0 0 0 0 1 0 0 0  0  0  0  0  0  1  0  0  0  1  0  0  1  1  0  0  0  0  0
  4  0 0 0 1 1 0 1 0 1  1  0  1  0  1  0  1  0  0  0  1  1  1  0  0  0  0  0  1
  5  1 0 0 1 0 1 0 0 0  0  0  0  1  0  0  0  1  0  1  0  1  0  1  1  1  0  0  0
  6  1 1 1 0 0 1 0 0 1  0  0  1  0  0  1  1  0  0  0  0  0  0  0  0  1  0  1  0
  7  0 0 0 0 1 0 0 0 0  0  0  0  0  0  1  0  0  1  1  0  0  0  0  0  1  1  0  0
  8  0 1 1 0 0 0 1 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  9  0 0 0 0 1 0 0 0 0  0  0  0  0  1  0  1  0  1  0  0  0  0  1  0  1  1  0  1
  10 0 0 1 0 1 0 0 0 0  0  0  0  1  0  0  0  0  0  0  1  0  0  1  1  0  0  0  0
  11 0 0 0 1 1 1 0 1 0  1  1  1  0  1  0  1  1  0  0  1  0  1  1  1  0  1  0  0
  12 0 0 0 1 0 0 0 0 1  0  1  0  1  0  0  0  0  0  0  0  0  1  0  0  1  0  0  1
  13 1 0 0 0 1 1 0 1 1  0  0  0  1  0  0  0  0  1  0  1  0  1  1  0  1  0  0  0
  14 0 1 0 0 0 0 1 1 0  1  1  1  0  1  0  1  1  0  0  1  0  1  0  0  0  1  0  1
  15 1 1 1 1 0 1 1 0 0  0  1  0  1  0  0  0  1  1  1  0  0  0  0  0  0  1  0  1
  16 1 0 1 0 0 0 0 0 0  0  0  0  0  1  0  0  0  1  0  0  0  0  0  1  1  1  1  1
  17 1 0 0 0 1 1 1 1 0  1  1  1  0  0  0  1  1  0  0  0  1  0  0  1  1  1  0  0
  18 0 0 0 0 1 0 1 0 0  1  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0
  19 1 0 0 0 0 0 1 0 1  1  1  0  1  0  1  0  0  1  0  0  1  0  0  0  0  0  1  1
  20 0 1 0 1 1 0 1 0 1  1  0  1  0  0  0  1  0  0  0  1  1  0  1  0  1  0  1  0
  21 0 0 1 1 0 0 1 1 0  1  0  0  1  0  1  0  0  0  0  0  0  0  0  0  1  1  1  0
  22 0 0 1 0 0 0 1 1 0  0  0  0  0  1  1  0  1  0  0  1  1  0  1  0  0  1  1  1
  23 0 1 0 0 0 0 0 0 0  0  1  1  0  0  1  0  1  1  0  0  1  0  1  0  0  0  1  1
  24 1 1 0 1 0 0 0 1 0  0  1  1  0  0  1  0  0  0  1  1  0  1  0  0  0  0  0  0
  25 0 0 0 0 0 0 0 1 1  0  0  0  0  1  0  0  0  1  1  0  0  0  0  1  0  0  0  0
  26 0 1 0 1 0 0 0 0 0  0  0  0  0  0  0  0  0  0  0  1  1  0  0  0  0  1  1  1
  27 0 0 1 0 0 0 0 1 1  0  0  0  1  1  0  1  0  0  1  1  0  1  0  1  0  0  0  0
  28 0 0 0 0 0 1 0 0 1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  0  0  1  0
  29 0 1 0 1 0 1 0 0 1  0  1  0  0  0  0  1  1  1  1  0  0  0  0  1  0  0  0  0
  30 1 0 1 0 1 0 0 1 0  1  0  1  1  1  0  1  0  1  0  0  0  0  0  0  0  0  1  0
    g
     29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53
  1   0  0  1  0  0  1  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0
  2   0  0  0  1  0  0  1  0  0  0  0  1  0  1  0  0  0  0  0  0  0  1  0  1  0
  3   1  0  0  0  0  0  0  0  1  1  0  0  1  1  0  0  0  0  1  0  0  0  1  0  0
  4   1  1  0  0  0  1  1  1  0  0  0  0  1  1  1  0  0  1  0  0  0  0  0  0  0
  5   0  0  0  0  0  1  1  0  0  0  0  0  1  1  0  0  0  0  0  1  0  1  0  0  1
  6   0  0  0  0  0  0  0  0  0  1  0  0  0  1  0  1  0  0  0  0  1  0  0  0  0
  7   0  0  0  0  0  0  0  0  1  0  0  1  1  0  0  0  1  0  1  0  1  0  0  0  0
  8   1  1  0  1  0  0  1  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0
  9   1  0  1  0  0  0  0  1  1  1  0  1  0  0  1  0  1  1  0  0  0  0  0  0  1
  10  1  1  0  0  0  0  0  0  0  0  0  1  1  0  0  1  0  0  0  0  0  0  0  0  0
  11  1  0  1  1  1  0  0  1  1  0  0  1  0  1  0  1  0  1  1  0  0  0  1  1  0
  12  0  1  0  1  0  1  0  0  0  0  1  0  0  0  0  1  0  1  0  1  1  0  0  1  0
  13  0  1  1  0  1  0  1  0  0  1  1  1  1  1  1  0  1  0  1  1  1  1  1  0  1
  14  0  0  0  1  1  0  1  0  0  0  0  0  1  0  0  0  1  1  0  1  1  0  1  0  1
  15  0  0  1  0  0  0  0  1  1  0  0  0  0  1  1  0  0  0  0  0  0  0  0  0  0
  16  0  1  0  0  0  0  0  1  0  0  1  0  1  1  1  1  0  0  1  1  1  1  1  1  0
  17  1  0  1  0  1  0  1  0  0  0  1  0  0  0  0  1  1  0  0  1  0  1  0  0  0
  18  0  0  1  0  0  1  0  0  0  1  0  0  0  0  0  0  0  0  0  1  0  1  1  0  0
  19  0  1  0  0  1  1  0  1  0  1  1  0  0  0  0  0  0  0  0  0  0  1  0  1  0
  20  1  0  0  1  0  1  0  0  0  1  0  1  0  0  0  1  1  1  1  0  1  0  0  1  0
  21  0  0  0  1  1  0  0  1  0  0  0  1  0  0  1  0  0  1  0  1  0  0  1  1  1
  22  0  1  0  1  0  0  0  0  0  1  0  1  0  0  1  1  0  1  1  0  1  0  0  1  1
  23  0  0  1  0  0  1  0  0  1  1  1  0  0  0  0  1  1  0  0  1  1  0  0  0  0
  24  0  0  0  0  1  1  1  0  0  0  1  0  1  0  0  0  0  0  0  0  0  0  0  0  1
  25  0  0  1  0  0  0  0  1  0  1  0  0  0  0  1  0  1  1  0  0  0  0  0  0  0
  26  0  0  1  1  1  1  1  1  0  0  1  1  0  0  1  0  0  0  1  0  0  1  1  1  1
  27  1  1  0  0  1  0  1  0  0  0  0  0  1  0  0  0  0  1  1  0  0  1  1  0  1
  28  0  1  0  1  1  0  0  0  1  0  0  0  0  0  0  1  1  0  1  0  1  0  0  0  0
  29  1  0  0  0  0  0  0  1  1  0  1  0  0  1  0  0  0  0  0  0  0  0  0  1  0
  30  0  0  0  0  0  0  0  0  1  0  1  0  0  0  0  0  1  0  0  1  0  1  0  0  1
    g
     54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78
  1   0  0  0  0  0  0  1  0  0  0  0  1  0  0  0  0  1  1  0  0  0  0  1  0  0
  2   0  0  0  0  0  0  1  1  0  0  1  0  0  0  0  1  0  0  0  0  0  0  1  1  0
  3   1  1  0  0  1  0  0  0  1  0  0  0  0  0  0  1  1  0  0  1  0  0  0  0  0
  4   0  1  1  0  0  1  1  0  1  1  0  1  1  0  1  1  0  0  0  0  1  0  0  1  0
  5   1  0  1  0  0  0  0  0  1  0  0  1  0  1  0  0  1  0  0  0  0  0  1  0  1
  6   0  0  0  0  0  1  0  0  1  0  0  0  0  0  1  1  0  0  1  0  0  0  0  0  0
  7   0  1  0  0  1  0  0  0  0  0  1  0  1  0  0  0  0  0  1  0  0  0  0  0  0
  8   0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0
  9   0  1  0  0  0  0  0  0  0  1  0  1  1  1  0  0  0  0  0  0  1  0  1  0  1
  10  0  0  0  1  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  1  1  1  0
  11  0  0  0  1  0  1  1  1  0  1  1  0  0  1  0  1  0  1  0  0  1  1  0  1  0
  12  1  0  1  0  0  0  0  0  0  1  1  0  0  0  1  1  0  0  0  1  1  0  0  1  1
  13  0  0  0  1  0  0  0  0  0  1  1  1  0  0  0  0  0  1  1  1  1  0  0  0  1
  14  1  0  1  1  0  1  1  0  0  1  0  1  0  0  0  1  0  1  1  0  0  0  0  0  0
  15  0  0  1  0  1  0  1  1  0  0  0  0  1  1  1  1  0  1  0  1  0  0  0  0  0
  16  1  0  1  1  0  1  0  0  0  0  1  0  0  0  1  0  0  0  0  1  0  0  0  0  0
  17  1  1  0  1  0  0  0  1  0  1  0  0  1  1  0  0  0  0  0  1  0  1  0  0  0
  18  0  0  0  1  1  0  0  0  1  0  0  0  0  0  0  1  1  0  0  1  0  1  0  0  1
  19  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  1  0  0  0  0  0
  20  1  0  0  1  0  1  0  0  0  0  1  1  0  1  0  1  0  0  1  0  1  1  0  0  0
  21  0  0  1  0  0  0  1  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0
  22  0  0  1  1  1  1  1  1  1  0  0  1  0  1  1  0  0  0  0  0  0  1  0  0  1
  23  0  1  0  1  0  0  0  0  1  1  0  0  1  0  1  0  1  1  1  0  1  1  1  0  1
  24  1  1  1  0  1  0  0  0  1  0  0  1  0  0  0  0  1  1  1  0  0  0  0  1  0
  25  0  1  1  0  0  0  0  0  0  0  0  0  1  1  0  0  1  1  0  0  0  0  1  0  0
  26  0  1  0  0  1  1  1  0  1  0  0  1  1  0  0  0  0  0  1  0  0  0  1  0  1
  27  0  1  0  0  1  1  1  1  1  1  1  0  0  0  0  0  1  0  0  1  0  0  1  1  1
  28  1  0  0  0  0  1  0  1  0  1  0  0  1  1  1  0  0  1  1  0  1  1  0  0  0
  29  1  0  0  0  1  0  0  0  0  0  1  0  1  1  0  0  1  0  1  0  0  1  1  1  0
  30  0  0  0  0  1  0  0  1  0  0  1  0  0  0  0  0  1  1  0  1  1  1  0  1  1
    g
     79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100
  1   0  1  1  1  1  1  0  0  0  1  0  0  1  1  0  0  0  0  0  0  1   0
  2   1  0  0  0  1  0  1  1  0  1  0  0  0  0  0  0  0  0  1  0  0   1
  3   1  0  0  0  0  0  0  1  0  0  1  1  1  0  0  1  0  0  0  1  0   0
  4   0  1  1  0  0  1  0  0  0  0  1  1  0  0  0  0  0  0  0  1  0   1
  5   1  0  0  1  0  1  0  1  1  0  0  0  0  1  1  0  0  1  1  1  1   0
  6   0  0  1  0  0  0  1  1  1  0  0  0  1  0  0  0  0  1  0  1  0   0
  7   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0   0
  8   0  1  1  0  1  0  0  0  0  0  1  0  1  0  0  0  0  0  0  0  0   1
  9   0  0  1  0  0  0  0  0  0  0  1  1  1  1  1  1  0  1  0  0  1   1
  10  0  0  0  1  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0   0
  11  0  0  0  1  0  0  0  0  0  1  0  0  0  1  0  1  1  0  0  0  0   0
  12  0  1  1  1  1  1  0  0  0  0  0  0  0  0  0  0  1  1  0  0  0   0
  13  1  0  0  1  0  0  1  0  1  0  1  0  0  1  1  1  1  0  0  0  0   0
  14  0  0  0  0  1  1  0  0  0  1  0  0  0  0  0  0  1  0  0  0  0   0
  15  0  1  0  0  1  1  0  1  0  0  0  0  0  0  1  0  1  0  1  1  0   0
  16  0  1  1  1  0  0  1  0  1  1  0  0  1  0  0  0  0  1  1  0  0   0
  17  0  0  0  0  0  0  1  1  1  0  0  0  0  0  1  1  1  0  1  0  0   1
  18  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  1  1  0  0  0   0
  19  0  0  0  0  0  0  1  0  0  0  0  1  0  0  0  0  0  0  0  0  0   0
  20  0  0  1  1  0  0  1  0  0  0  1  0  1  1  1  1  0  0  0  1  1   1
  21  1  0  0  0  0  0  0  1  0  1  0  1  0  0  0  0  0  1  1  0  1   1
  22  1  0  0  0  1  0  1  1  0  0  0  1  0  1  0  0  1  1  0  1  1   1
  23  0  1  0  1  0  0  1  0  1  0  0  0  0  0  0  0  1  0  1  1  1   0
  24  0  0  0  0  0  1  0  1  1  0  1  1  1  0  0  1  0  0  0  0  1   0
  25  1  1  1  0  0  0  1  1  1  0  1  0  1  0  1  1  0  0  1  0  1   1
  26  1  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  1  0   0
  27  1  0  0  0  1  0  0  0  1  1  0  1  0  1  0  1  0  0  0  0  0   0
  28  1  1  1  1  1  0  0  0  1  1  1  0  0  1  1  0  1  0  0  1  0   0
  29  0  0  0  0  1  1  0  0  0  1  0  0  1  0  1  1  0  1  1  0  0   0
  30  0  1  0  0  0  1  0  0  0  1  1  1  0  1  0  0  0  1  1  0  1   1
> stopifnot(all(tab3 %in% 0:1))
> 
> ###**********************************************************
> 
> cl4 <- stepFlexclust(as.matrix(iris[,-5]), K=10, group = iris[, 5])
10 : * * *
> tab4 <- table(predict(cl4),iris$Species)
> tab4
   
    setosa versicolor virginica
  1      0         50         0
  2     50          0         0
  3      0          0        50
> stopifnot(all(tab4 %in% c(0, 50)))
> 
> 
> 
> 
